function Gravita = CGravita2(qDH)
%Calcola le coppie di Gravit�
% Ingressi:
%       qDH : vettori 6x1 secondo convenzioni DH in rad
% 
% Uscite:
%       Gravit�: Coppie di Gravit� g(qDH) in convenzione DH
%
% Note:
%   le coppie in uscita sono in convenzione DH e sono quelle richieste agli attuatori (a valle dei riduttori)
%
% File letti:
%            costanti.m : definizione delle costanti dinamiche utilizzate

% DUBBI: 
%            non sono sicuro sulla conversione da cioppie COMAU a coppie DH


% **********************************************************************************************************************
% Costanti
% **********************************************************************************************************************

% Lettura dei dati registrati in "costanti.m"
  % addpath('../modello SIX/')

  q1 = qDH(1);
  q2 = qDH(2);
  q3 = qDH(3);
  q4 = qDH(4);
  q5 = qDH(5);
  q6 = qDH(6);
 Gravita = zeros(8,1);

 Gravita(1:6) = [ 0.
                                                                     41.831982838746632733517571978155*sin(q3)*cos(q2)+41.831982838746632733517571978155*cos(q3)*sin(q2)-40.888143981693086939088743747561*cos(q3)*cos(q2)+40.888143981693086939088743747561*sin(q3)*sin(q2)+.51801607185470996831677670257931*cos(q4)*sin(q5)*cos(q3)*cos(q2)-.84385585145070018554119828380067e-1*cos(q4)*cos(q5)*sin(q3)*sin(q2)+.84385585145070018554119828380067e-1*cos(q4)*cos(q5)*cos(q3)*cos(q2)+.79253287965000011221824299800786e-3*cos(q6)*cos(q4)*cos(q5)*sin(q3)*sin(q2)-.79253287965000011221824299800786e-3*cos(q6)*cos(q4)*cos(q5)*cos(q3)*cos(q2)-.51801607185470996831677670257931*cos(q4)*sin(q5)*sin(q3)*sin(q2)+.80436172859999995465044237211160e-4*sin(q6)*cos(q4)*cos(q5)*sin(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q6)*cos(q4)*cos(q5)*cos(q3)*cos(q2)-2.3966116388136899928440470830537*sin(q2)-294.63271669184564416354987770319*cos(q2)-.79253287965000011221824299800786e-3*sin(q4)*sin(q6)*sin(q3)*sin(q2)+.71102308856895000688247421294363*sin(q4)*cos(q3)*cos(q2)-.71102308856895000688247421294363*sin(q4)*sin(q3)*sin(q2)+.51801607185470996831677670257931*cos(q5)*cos(q3)*sin(q2)-.84385585145070018554119828380067e-1*sin(q5)*cos(q3)*sin(q2)-.84385585145070018554119828380067e-1*sin(q5)*sin(q3)*cos(q2)+.51801607185470996831677670257931*cos(q5)*sin(q3)*cos(q2)+.79253287965000011221824299800786e-3*sin(q4)*sin(q6)*cos(q3)*cos(q2)+.80436172859999995465044237211160e-4*sin(q4)*cos(q6)*sin(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q4)*cos(q6)*cos(q3)*cos(q2)+.79253287965000011221824299800786e-3*sin(q5)*cos(q6)*cos(q3)*sin(q2)+.80436172859999995465044237211160e-4*sin(q5)*sin(q6)*cos(q3)*sin(q2)+.80436172859999995465044237211160e-4*sin(q5)*sin(q6)*sin(q3)*cos(q2)+.79253287965000011221824299800786e-3*sin(q5)*cos(q6)*sin(q3)*cos(q2)+2.4589364943204897634432271047444*cos(q4)*cos(q3)*cos(q2)-2.4589364943204897634432271047444*cos(q4)*sin(q3)*sin(q2);
                                                                                                                                                        -41.831982838746632733517571978155*sin(q3)*cos(q2)-41.831982838746632733517571978155*cos(q3)*sin(q2)+40.888143981693086939088743747561*cos(q3)*cos(q2)-40.888143981693086939088743747561*sin(q3)*sin(q2)-.51801607185470996831677670257931*cos(q4)*sin(q5)*cos(q3)*cos(q2)+.84385585145070018554119828380067e-1*cos(q4)*cos(q5)*sin(q3)*sin(q2)-.84385585145070018554119828380067e-1*cos(q4)*cos(q5)*cos(q3)*cos(q2)-.79253287965000011221824299800786e-3*cos(q6)*cos(q4)*cos(q5)*sin(q3)*sin(q2)+.79253287965000011221824299800786e-3*cos(q6)*cos(q4)*cos(q5)*cos(q3)*cos(q2)+.51801607185470996831677670257931*cos(q4)*sin(q5)*sin(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q6)*cos(q4)*cos(q5)*sin(q3)*sin(q2)+.80436172859999995465044237211160e-4*sin(q6)*cos(q4)*cos(q5)*cos(q3)*cos(q2)+.79253287965000011221824299800786e-3*sin(q4)*sin(q6)*sin(q3)*sin(q2)-.71102308856895000688247421294363*sin(q4)*cos(q3)*cos(q2)+.71102308856895000688247421294363*sin(q4)*sin(q3)*sin(q2)-.51801607185470996831677670257931*cos(q5)*cos(q3)*sin(q2)+.84385585145070018554119828380067e-1*sin(q5)*cos(q3)*sin(q2)+.84385585145070018554119828380067e-1*sin(q5)*sin(q3)*cos(q2)-.51801607185470996831677670257931*cos(q5)*sin(q3)*cos(q2)-.79253287965000011221824299800786e-3*sin(q4)*sin(q6)*cos(q3)*cos(q2)-.80436172859999995465044237211160e-4*sin(q4)*cos(q6)*sin(q3)*sin(q2)+.80436172859999995465044237211160e-4*sin(q4)*cos(q6)*cos(q3)*cos(q2)-.79253287965000011221824299800786e-3*sin(q5)*cos(q6)*cos(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q5)*sin(q6)*cos(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q5)*sin(q6)*sin(q3)*cos(q2)-.79253287965000011221824299800786e-3*sin(q5)*cos(q6)*sin(q3)*cos(q2)-2.4589364943204897634432271047444*cos(q4)*cos(q3)*cos(q2)+2.4589364943204897634432271047444*cos(q4)*sin(q3)*sin(q2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  -.79253287965000011221824299800786e-3*cos(q5)*cos(q6)*sin(q4)*cos(q3)*sin(q2)-.79253287965000011221824299800786e-3*cos(q5)*cos(q6)*sin(q4)*sin(q3)*cos(q2)+2.4589364943204897634432271047444*sin(q4)*cos(q3)*sin(q2)+.51801607185470996831677670257931*sin(q4)*sin(q5)*sin(q3)*cos(q2)+.51801607185470996831677670257931*sin(q4)*sin(q5)*cos(q3)*sin(q2)+.84385585145070018554119828380067e-1*sin(q4)*cos(q5)*cos(q3)*sin(q2)+.84385585145070018554119828380067e-1*sin(q4)*cos(q5)*sin(q3)*cos(q2)-.71102308856895000688247421294364*cos(q4)*cos(q3)*sin(q2)-.71102308856895000688247421294364*cos(q4)*sin(q3)*cos(q2)+.80436172859999995465044237211160e-4*cos(q6)*cos(q4)*cos(q3)*sin(q2)-.79253287965000011221824299800786e-3*sin(q6)*cos(q4)*cos(q3)*sin(q2)-.79253287965000011221824299800786e-3*sin(q6)*cos(q4)*sin(q3)*cos(q2)+.80436172859999995465044237211160e-4*cos(q6)*cos(q4)*sin(q3)*cos(q2)+2.4589364943204897634432271047444*sin(q4)*sin(q3)*cos(q2)-.80436172859999995465044237211160e-4*cos(q5)*sin(q6)*sin(q4)*cos(q3)*sin(q2)-.80436172859999995465044237211160e-4*cos(q5)*sin(q6)*sin(q4)*sin(q3)*cos(q2);
 .80436172859999995465044237211160e-4*sin(q6)*cos(q5)*sin(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q6)*cos(q5)*cos(q3)*cos(q2)+.79253287965000011221824299800786e-3*cos(q6)*cos(q5)*sin(q3)*sin(q2)-.79253287965000011221824299800786e-3*cos(q6)*cos(q5)*cos(q3)*cos(q2)-.84385585145070018554119828380067e-1*sin(q5)*cos(q4)*cos(q3)*sin(q2)-.84385585145070018554119828380067e-1*cos(q5)*sin(q3)*sin(q2)+.51801607185470996831677670257931*sin(q5)*cos(q3)*cos(q2)-.51801607185470996831677670257931*sin(q5)*sin(q3)*sin(q2)+.84385585145070018554119828380067e-1*cos(q5)*cos(q3)*cos(q2)-.15850657593000001745801267206276e-4*sin(q6)*cos(q5)*cos(q4)*cos(q3)*sin(q2)-.15850657593000001745801267206276e-4*sin(q6)*cos(q5)*cos(q4)*sin(q3)*cos(q2)+.16087234571999998469804356499881e-5*cos(q6)*cos(q5)*cos(q4)*cos(q3)*sin(q2)+.16087234571999998469804356499881e-5*cos(q6)*cos(q5)*cos(q4)*sin(q3)*cos(q2)+.79253287965000011221824299800786e-3*cos(q6)*sin(q5)*cos(q4)*cos(q3)*sin(q2)+.79253287965000011221824299800786e-3*cos(q6)*sin(q5)*cos(q4)*sin(q3)*cos(q2)+.80436172859999995465044237211160e-4*sin(q6)*sin(q5)*cos(q4)*cos(q3)*sin(q2)+.80436172859999995465044237211160e-4*sin(q6)*sin(q5)*cos(q4)*sin(q3)*cos(q2)-.84385585145070018554119828380067e-1*sin(q5)*cos(q4)*sin(q3)*cos(q2)+.51801607185470996831677670257931*cos(q5)*cos(q4)*sin(q3)*cos(q2)+.51801607185470996831677670257931*cos(q5)*cos(q4)*cos(q3)*sin(q2)-.16087234571999998469804356499881e-5*cos(q6)*sin(q5)*sin(q3)*sin(q2)-.16087234571999998469804356499881e-5*sin(q6)*sin(q4)*sin(q3)*cos(q2)-.16087234571999998469804356499881e-5*sin(q6)*sin(q4)*cos(q3)*sin(q2)+.16087234571999998469804356499881e-5*cos(q6)*sin(q5)*cos(q3)*cos(q2)-.15850657593000001745801267206276e-4*cos(q6)*sin(q4)*sin(q3)*cos(q2)-.15850657593000001745801267206276e-4*cos(q6)*sin(q4)*cos(q3)*sin(q2)-.15850657593000001745801267206276e-4*sin(q6)*sin(q5)*cos(q3)*cos(q2)+.15850657593000001745801267206276e-4*sin(q6)*sin(q5)*sin(q3)*sin(q2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -.80436172859999995465044237211160e-4*sin(q6)*sin(q4)*cos(q3)*sin(q2)-.80436172859999995465044237211160e-4*sin(q6)*sin(q4)*sin(q3)*cos(q2)-.79253287965000011221824299800786e-3*sin(q6)*cos(q5)*cos(q4)*cos(q3)*sin(q2)-.79253287965000011221824299800786e-3*sin(q6)*cos(q5)*cos(q4)*sin(q3)*cos(q2)+.79253287965000011221824299800786e-3*sin(q6)*sin(q5)*sin(q3)*sin(q2)-.79253287965000011221824299800786e-3*sin(q6)*sin(q5)*cos(q3)*cos(q2)-.79253287965000011221824299800786e-3*cos(q6)*sin(q4)*cos(q3)*sin(q2)-.79253287965000011221824299800786e-3*cos(q6)*sin(q4)*sin(q3)*cos(q2)+.80436172859999995465044237211160e-4*cos(q6)*cos(q5)*cos(q4)*cos(q3)*sin(q2)+.80436172859999995465044237211160e-4*cos(q6)*cos(q5)*cos(q4)*sin(q3)*cos(q2)-.80436172859999995465044237211160e-4*cos(q6)*sin(q5)*sin(q3)*sin(q2)+.80436172859999995465044237211160e-4*cos(q6)*sin(q5)*cos(q3)*cos(q2)];
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

H = [    -1     0     0     0     0     0;
     0     1     0     0     0     0;
     0     0    -1     0     0     0;
     0     0     0    -1     0     0;
     0     0     0     0     1     0;
     0     0     0     0     0    -1];
 
 Gravita(1:6) = (H')^-1*Gravita(1:6);
 
 
 
 