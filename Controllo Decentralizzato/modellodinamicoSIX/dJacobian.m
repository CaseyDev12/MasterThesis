function dJ = mat_djac(qdh,dqdh)
%
% SIX - Gennaio 2005
%
% function dJ = mat_djac(q,dq)
%
%                                                                           .    n   dJij(q)  .
% calcola in numerico la matrice dJ(q,q) il cui elemento generico e' dJij(q,q)= Sum --------- qk 
%                                                                               k=1    dqk
%   dove Jij e' l'elemento generico della Jacobiano
%
% Ingressi:
%    qDH : vettore 6x1 contenente le posizioni (in rad)     ai giunti in
%    convenzione DH
%   dqDH : vettore 6x1 contenente le velocita' (in rad/sec) ai giunti in
%   convenzione DH
% Uscite:
%   dJ : matrice 6x6 contenente la matrice dJ
%        i dati che si possono ricavare dal suo uso sono in convenzione DH ai giunti in m/sec e rad/sec


%************************************************************************************************************************
% Parametri DH
%************************************************************************************************************************
qcomau = dh2comau(qdh*180/pi);
dqcomau = dh2comau_vel(dqdh*180/pi);
dJ = mat_djac(qcomau, dqcomau);



% 
%   [a,d,alpha] = dh_table;
%   a1 = a(1); a2 = a(2); a3 = a(3); a4 = a(4); a5 = a(5); a6 = a(6);
%   d1 = d(1); d2 = d(2); d3 = d(3); d4 = d(4); d5 = d(5); d6 = d(6);
% 
% 
% %************************************************************************************************************************
% % Conversione delle grandezze
% %************************************************************************************************************************
% 
%     q1 = qdh(1); q2 = qdh(2); q3 = qdh(3); q4 = qdh(4); q5 = qdh(5); q6 = qdh(6);
% 
%   % rinomina le variabili delle velocita': le variabili dqi saranno le velocita' dh in rad/sec
%     dq1 = dqdh(1); dq2 = dqdh(2); dq3 = dqdh(3); dq4 = dqdh(4); dq5 = dqdh(5); dq6 = dqdh(6);
% 
% 
% %************************************************************************************************************************
% % Calcolo della matrice dJ
% %************************************************************************************************************************
%     
%   dJ(1,1) = (-(-((1/2*cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*cos(q4)+sin(q1)*sin(q4))*sin(q5)+(-1/2*...
%             sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*cos(q5))*d6-(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*d4-1/2*a3*...
%             cos(q3+q1+q2)-1/2*a3*cos(q3-q1+q2)-1/2*a2*cos(q1+q2)-1/2*a2*cos(-q1+q2)-a1*cos(q1))*dq1+(-(-(1/2*...
%             cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*cos(q4)*sin(q5)+(-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*cos(q5))*...
%             d6-(-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*d4-1/2*a3*cos(q3+q1+q2)+1/2*a3*cos(q3-q1+q2)-1/2*a2*...
%             cos(q1+q2)+1/2*a2*cos(-q1+q2))*dq2+(-(-(1/2*cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*cos(q4)*...
%             sin(q5)+(-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*cos(q5))*d6-(-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*...
%             d4-1/2*a3*cos(q3+q1+q2)+1/2*a3*cos(q3-q1+q2))*dq3+(-(1/2*sin(q3+q1+q2)-1/2*sin(q3-q1+q2))*...
%             sin(q4)-cos(q1)*cos(q4))*sin(q5)*d6*dq4-(-((1/2*sin(q3+q1+q2)-1/2*sin(q3-q1+q2))*cos(q4)-cos(q1)*...
%             sin(q4))*cos(q5)-(1/2*cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*sin(q5))*d6*dq5;
%   dJ(1,2) = -sin(q1)*((sin(q2+q3)*cos(q4)*sin(q5)-cos(q2+q3)*cos(q5))*d6-cos(q2+q3)*d4-a3*sin(q2+q3)-a2*...
%             sin(q2))*dq1+cos(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*d4-a3*...
%             cos(q2+q3)-a2*cos(q2))*dq2+cos(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*...
%             d4-a3*cos(q2+q3))*dq3-cos(q1)*sin(q2+q3)*sin(q4)*sin(q5)*d6*dq4+cos(q1)*(sin(q2+q3)*cos(q4)*...
%             cos(q5)+cos(q2+q3)*sin(q5))*d6*dq5;
%   dJ(1,3) = -sin(q1)*((sin(q2+q3)*cos(q4)*sin(q5)-cos(q2+q3)*cos(q5))*d6-cos(q2+q3)*d4-a3*sin(q2+q3))*...
%             dq1+cos(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*d4-a3*cos(q2+q3))*...
%             dq2+cos(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*d4-a3*cos(q2+q3))*...
%             dq3-cos(q1)*sin(q2+q3)*sin(q4)*sin(q5)*d6*dq4+cos(q1)*(sin(q2+q3)*cos(q4)*cos(q5)+cos(q2+q3)*...
%             sin(q5))*d6*dq5;
%   dJ(1,4) = 1/2*d6*sin(q5)*(-sin(q3+q1+q2)*sin(q2+q3)*cos(q4)-sin(q3-q1+q2)*sin(q2+q3)*cos(q4)-cos(q2+q3)*...
%             cos(q4)*cos(q3+q1+q2)-cos(q2+q3)*cos(q4)*cos(q3-q1+q2)-2*cos(q2+q3)*sin(q1)*sin(q4))*dq1-d6*...
%             sin(q5)*sin(q2+q3)*cos(q1)*sin(q4)*dq2-d6*sin(q5)*sin(q2+q3)*cos(q1)*sin(q4)*dq3+1/2*d6*sin(q5)*...
%             (-cos(q3+q1+q2)*sin(q2+q3)*sin(q4)+cos(q3-q1+q2)*sin(q2+q3)*sin(q4)+cos(q2+q3)*sin(q4)*...
%             sin(q3+q1+q2)-cos(q2+q3)*sin(q4)*sin(q3-q1+q2)+2*cos(q2+q3)*cos(q1)*cos(q4))*dq4+1/2*d6*cos(q5)*...
%             (cos(q3+q1+q2)*sin(q2+q3)*cos(q4)-cos(q3-q1+q2)*sin(q2+q3)*cos(q4)-cos(q2+q3)*cos(q4)*...
%             sin(q3+q1+q2)+cos(q2+q3)*cos(q4)*sin(q3-q1+q2)+2*cos(q2+q3)*cos(q1)*sin(q4))*dq5;
%   dJ(1,5) = -1/2*d6*(2*sin(q2+q3)*sin(q5)*sin(q1)+sin(q2+q3)*sin(q4)*cos(q5)*sin(q3-q1+q2)+sin(q2+q3)*sin(q4)*...
%             cos(q5)*sin(q3+q1+q2)+sin(q4)*cos(q3-q1+q2)*cos(q2+q3)*cos(q5)+sin(q4)*cos(q3+q1+q2)*cos(q2+q3)*...
%             cos(q5)-2*sin(q1)*cos(q4)*cos(q2+q3)*cos(q5))*dq1-1/2*d6*(-2*cos(q1)*cos(q4)*sin(q2+q3)*cos(q5)-2*...
%             cos(q2+q3)*sin(q5)*cos(q1))*dq2-1/2*d6*(-2*cos(q1)*cos(q4)*sin(q2+q3)*cos(q5)-2*cos(q2+q3)*...
%             sin(q5)*cos(q1))*dq3-1/2*d6*(cos(q4)*sin(q3+q1+q2)*cos(q2+q3)*cos(q5)-cos(q4)*sin(q3-q1+q2)*...
%             cos(q2+q3)*cos(q5)-2*cos(q1)*sin(q4)*cos(q2+q3)*cos(q5)-sin(q2+q3)*cos(q4)*cos(q5)*...
%             cos(q3+q1+q2)+sin(q2+q3)*cos(q4)*cos(q5)*cos(q3-q1+q2))*dq4-1/2*d6*(-sin(q4)*sin(q3+q1+q2)*...
%             cos(q2+q3)*sin(q5)+sin(q4)*sin(q3-q1+q2)*cos(q2+q3)*sin(q5)-2*cos(q1)*cos(q4)*cos(q2+q3)*...
%             sin(q5)-2*sin(q2+q3)*cos(q5)*cos(q1)+sin(q2+q3)*sin(q4)*sin(q5)*cos(q3+q1+q2)-sin(q2+q3)*sin(q4)*...
%             sin(q5)*cos(q3-q1+q2))*dq5;
%   dJ(1,6) = 0;
%  
%   dJ(2,1) = ((-((-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*cos(q4)+cos(q1)*sin(q4))*sin(q5)+(1/2*...
%             cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*cos(q5))*d6+(1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*d4+1/2*a3*...
%             sin(q3-q1+q2)-1/2*a3*sin(q3+q1+q2)+1/2*a2*sin(-q1+q2)-1/2*a2*sin(q1+q2)-a1*sin(q1))*dq1+((-(-1/2*...
%             sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*cos(q4)*sin(q5)+(-1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*cos(q5))*...
%             d6+(-1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*d4-1/2*a3*sin(q3-q1+q2)-1/2*a3*sin(q3+q1+q2)-1/2*a2*...
%             sin(-q1+q2)-1/2*a2*sin(q1+q2))*dq2+((-(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*cos(q4)*...
%             sin(q5)+(-1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*cos(q5))*d6+(-1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*...
%             d4-1/2*a3*sin(q3-q1+q2)-1/2*a3*sin(q3+q1+q2))*dq3-(-(1/2*cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*...
%             sin(q4)+sin(q1)*cos(q4))*sin(q5)*d6*dq4+(-((1/2*cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*cos(q4)+sin(q1)*...
%             sin(q4))*cos(q5)-(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*sin(q5))*d6*dq5;
%   dJ(2,2) = cos(q1)*((sin(q2+q3)*cos(q4)*sin(q5)-cos(q2+q3)*cos(q5))*d6-cos(q2+q3)*d4-a3*sin(q2+q3)-a2*...
%             sin(q2))*dq1+sin(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*d4-a3*...
%             cos(q2+q3)-a2*cos(q2))*dq2+sin(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*...
%             d4-a3*cos(q2+q3))*dq3-sin(q1)*sin(q2+q3)*sin(q4)*sin(q5)*d6*dq4+sin(q1)*(sin(q2+q3)*cos(q4)*...
%             cos(q5)+cos(q2+q3)*sin(q5))*d6*dq5;
%   dJ(2,3) = cos(q1)*((sin(q2+q3)*cos(q4)*sin(q5)-cos(q2+q3)*cos(q5))*d6-cos(q2+q3)*d4-a3*sin(q2+q3))*...
%             dq1+sin(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*d4-a3*cos(q2+q3))*...
%             dq2+sin(q1)*((cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*d6+sin(q2+q3)*d4-a3*cos(q2+q3))*...
%             dq3-sin(q1)*sin(q2+q3)*sin(q4)*sin(q5)*d6*dq4+sin(q1)*(sin(q2+q3)*cos(q4)*cos(q5)+cos(q2+q3)*...
%             sin(q5))*d6*dq5;
%   dJ(2,4) = 1/2*d6*sin(q5)*(cos(q3+q1+q2)*sin(q2+q3)*cos(q4)-cos(q3-q1+q2)*sin(q2+q3)*cos(q4)-cos(q2+q3)*...
%             cos(q4)*sin(q3+q1+q2)+cos(q2+q3)*cos(q4)*sin(q3-q1+q2)+2*cos(q2+q3)*cos(q1)*sin(q4))*dq1-d6*...
%             sin(q5)*sin(q2+q3)*sin(q1)*sin(q4)*dq2-d6*sin(q5)*sin(q2+q3)*sin(q1)*sin(q4)*dq3+1/2*d6*sin(q5)*...
%             (-cos(q2+q3)*sin(q4)*cos(q3-q1+q2)-cos(q2+q3)*sin(q4)*cos(q3+q1+q2)+2*cos(q2+q3)*sin(q1)*...
%             cos(q4)-sin(q3-q1+q2)*sin(q2+q3)*sin(q4)-sin(q3+q1+q2)*sin(q2+q3)*sin(q4))*dq4+1/2*d6*cos(q5)*...
%             (cos(q2+q3)*cos(q4)*cos(q3-q1+q2)+cos(q2+q3)*cos(q4)*cos(q3+q1+q2)+2*cos(q2+q3)*sin(q1)*...
%             sin(q4)+sin(q3-q1+q2)*sin(q2+q3)*cos(q4)+sin(q3+q1+q2)*sin(q2+q3)*cos(q4))*dq5;
%   dJ(2,5) = 1/2*d6*(2*sin(q2+q3)*sin(q5)*cos(q1)-sin(q2+q3)*sin(q4)*cos(q5)*cos(q3-q1+q2)+sin(q2+q3)*sin(q4)*...
%             cos(q5)*cos(q3+q1+q2)+sin(q4)*sin(q3-q1+q2)*cos(q2+q3)*cos(q5)-sin(q4)*sin(q3+q1+q2)*cos(q2+q3)*...
%             cos(q5)-2*cos(q1)*cos(q4)*cos(q2+q3)*cos(q5))*dq1+1/2*d6*(2*cos(q2+q3)*sin(q5)*sin(q1)+2*sin(q1)*...
%             cos(q4)*sin(q2+q3)*cos(q5))*dq2+1/2*d6*(2*cos(q2+q3)*sin(q5)*sin(q1)+2*sin(q1)*cos(q4)*sin(q2+q3)*...
%             cos(q5))*dq3+1/2*d6*(sin(q2+q3)*cos(q4)*cos(q5)*sin(q3-q1+q2)+sin(q2+q3)*cos(q4)*cos(q5)*...
%             sin(q3+q1+q2)+cos(q4)*cos(q3-q1+q2)*cos(q2+q3)*cos(q5)+cos(q4)*cos(q3+q1+q2)*cos(q2+q3)*cos(q5)+2*...
%             sin(q1)*sin(q4)*cos(q2+q3)*cos(q5))*dq4+1/2*d6*(2*sin(q2+q3)*cos(q5)*sin(q1)-sin(q2+q3)*sin(q4)*...
%             sin(q5)*sin(q3-q1+q2)-sin(q2+q3)*sin(q4)*sin(q5)*sin(q3+q1+q2)-sin(q4)*cos(q3-q1+q2)*cos(q2+q3)*...
%             sin(q5)-sin(q4)*cos(q3+q1+q2)*cos(q2+q3)*sin(q5)+2*sin(q1)*cos(q4)*cos(q2+q3)*sin(q5))*dq5;
%   dJ(2,6) = 0;
%  
%   dJ(3,1) = 0;
%   dJ(3,2) = -1/4*dq2*d6*cos(-q5+q2+q3-q4)+1/4*dq2*d6*cos(q5+q2+q3-q4)+dq2*d4*cos(q2+q3)+dq2*a2*sin(q2)-1/4*...
%             dq2*d6*cos(-q5+q2+q3+q4)+1/4*dq2*d6*cos(q5+q2+q3+q4)+1/2*dq2*d6*cos(q2+q3-q5)+dq2*a3*...
%             sin(q2+q3)+1/2*dq2*d6*cos(q2+q3+q5)-1/4*d6*dq4*cos(-q5+q2+q3+q4)+1/4*d6*dq4*cos(q5+q2+q3+q4)+1/4*...
%             d6*dq4*cos(-q5+q2+q3-q4)-1/4*d6*dq4*cos(q5+q2+q3-q4)+1/4*d6*dq5*cos(-q5+q2+q3+q4)+1/4*d6*dq5*...
%             cos(-q5+q2+q3-q4)+1/4*d6*dq5*cos(q5+q2+q3-q4)-1/2*d6*dq5*cos(q2+q3-q5)+1/2*d6*dq5*...
%             cos(q2+q3+q5)+1/4*d6*dq5*cos(q5+q2+q3+q4)-1/4*dq3*d6*cos(-q5+q2+q3+q4)+1/2*dq3*d6*...
%             cos(q2+q3-q5)+dq3*a3*sin(q2+q3)+1/2*dq3*d6*cos(q2+q3+q5)+1/4*dq3*d6*cos(q5+q2+q3+q4)-1/4*dq3*d6*...
%             cos(-q5+q2+q3-q4)+1/4*dq3*d6*cos(q5+q2+q3-q4)+dq3*d4*cos(q2+q3);
%   dJ(3,3) = 1/2*d6*dq5*cos(q2+q3+q5)+1/4*d6*dq5*cos(-q5+q2+q3+q4)+1/4*d6*dq5*cos(-q5+q2+q3-q4)+1/4*d6*dq5*...
%             cos(q5+q2+q3-q4)+1/4*d6*dq5*cos(q5+q2+q3+q4)-1/2*d6*dq5*cos(q2+q3-q5)-1/4*d6*dq4*...
%             cos(-q5+q2+q3+q4)+1/4*d6*dq4*cos(-q5+q2+q3-q4)-1/4*d6*dq4*cos(q5+q2+q3-q4)+1/4*d6*dq4*...
%             cos(q5+q2+q3+q4)+dq3*a3*sin(q2+q3)+1/2*dq3*d6*cos(q2+q3+q5)-1/4*dq3*d6*cos(-q5+q2+q3+q4)-1/4*dq3*...
%             d6*cos(-q5+q2+q3-q4)+dq3*d4*cos(q2+q3)+1/4*dq3*d6*cos(q5+q2+q3-q4)+1/4*dq3*d6*...
%             cos(q5+q2+q3+q4)+1/2*dq3*d6*cos(q2+q3-q5)+1/4*dq2*d6*cos(q5+q2+q3+q4)+1/2*dq2*d6*...
%             cos(q2+q3-q5)+dq2*a3*sin(q2+q3)-1/4*dq2*d6*cos(-q5+q2+q3+q4)+dq2*d4*cos(q2+q3)+1/4*dq2*d6*...
%             cos(q5+q2+q3-q4)-1/4*dq2*d6*cos(-q5+q2+q3-q4)+1/2*dq2*d6*cos(q2+q3+q5);
%   dJ(3,4) = -1/4*dq2*d6*cos(q5+q2+q3-q4)-1/4*dq2*d6*cos(-q5+q2+q3+q4)+1/4*dq2*d6*cos(-q5+q2+q3-q4)+1/4*dq2*d6*...
%             cos(q5+q2+q3+q4)-1/4*dq3*d6*cos(q5+q2+q3-q4)-1/4*dq3*d6*cos(-q5+q2+q3+q4)+1/4*dq3*d6*...
%             cos(-q5+q2+q3-q4)+1/4*dq3*d6*cos(q5+q2+q3+q4)-1/4*d6*dq4*cos(-q5+q2+q3+q4)+1/4*d6*dq4*...
%             cos(q5+q2+q3+q4)-1/4*d6*dq4*cos(-q5+q2+q3-q4)+1/4*d6*dq4*cos(q5+q2+q3-q4)-1/4*d6*dq5*...
%             cos(-q5+q2+q3-q4)+1/4*d6*dq5*cos(q5+q2+q3+q4)-1/4*d6*dq5*cos(q5+q2+q3-q4)+1/4*d6*dq5*...
%             cos(-q5+q2+q3+q4);
%   dJ(3,5) = 1/4*dq2*d6*cos(-q5+q2+q3+q4)+1/4*dq2*d6*cos(q5+q2+q3+q4)+1/4*dq2*d6*cos(-q5+q2+q3-q4)+1/4*dq2*d6*...
%             cos(q5+q2+q3-q4)-1/2*dq2*d6*cos(q2+q3-q5)+1/2*dq2*d6*cos(q2+q3+q5)+1/4*dq3*d6*...
%             cos(-q5+q2+q3+q4)+1/4*dq3*d6*cos(q5+q2+q3+q4)+1/4*dq3*d6*cos(-q5+q2+q3-q4)+1/4*dq3*d6*...
%             cos(q5+q2+q3-q4)-1/2*dq3*d6*cos(q2+q3-q5)+1/2*dq3*d6*cos(q2+q3+q5)+1/4*d6*dq4*...
%             cos(-q5+q2+q3+q4)+1/4*d6*dq4*cos(q5+q2+q3+q4)-1/4*d6*dq4*cos(-q5+q2+q3-q4)-1/4*d6*dq4*...
%             cos(q5+q2+q3-q4)-1/4*d6*dq5*cos(-q5+q2+q3+q4)+1/4*d6*dq5*cos(q5+q2+q3+q4)-1/4*d6*dq5*...
%             cos(-q5+q2+q3-q4)+1/4*d6*dq5*cos(q5+q2+q3-q4)+1/2*d6*dq5*cos(q2+q3-q5)+1/2*d6*dq5*cos(q2+q3+q5);
%   dJ(3,6) = 0;
%  
%   dJ(4,1) = 0;
%   dJ(4,2) = -cos(q1)*dq1;
%   dJ(4,3) = -cos(q1)*dq1;
%   dJ(4,4) = (1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*dq1+(-1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*dq2+(-1/2*...
%             cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*dq3;
%   dJ(4,5) = ((-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*sin(q4)-cos(q1)*cos(q4))*dq1+(-1/2*sin(q3-q1+q2)-1/2*...
%             sin(q3+q1+q2))*sin(q4)*dq2+(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*sin(q4)*dq3+((1/2*...
%             cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*cos(q4)+sin(q1)*sin(q4))*dq4;
%   dJ(4,6) = (-((-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*cos(q4)+cos(q1)*sin(q4))*sin(q5)+(1/2*cos(q3-q1+q2)-1/2*...
%             cos(q3+q1+q2))*cos(q5))*dq1+(-(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*cos(q4)*sin(q5)+(-1/2*...
%             cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*cos(q5))*dq2+(-(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*cos(q4)*...
%             sin(q5)+(-1/2*cos(q3-q1+q2)-1/2*cos(q3+q1+q2))*cos(q5))*dq3-(-(1/2*cos(q3-q1+q2)+1/2*...
%             cos(q3+q1+q2))*sin(q4)+sin(q1)*cos(q4))*sin(q5)*dq4+(-((1/2*cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*...
%             cos(q4)+sin(q1)*sin(q4))*cos(q5)-(-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*sin(q5))*dq5;
%  
%   dJ(5,1) = 0;
%   dJ(5,2) = -sin(q1)*dq1;
%   dJ(5,3) = -sin(q1)*dq1;
%   dJ(5,4) = (-1/2*sin(q3-q1+q2)-1/2*sin(q3+q1+q2))*dq1+(-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*dq2+(-1/2*...
%             sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*dq3;
%   dJ(5,5) = ((1/2*cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*sin(q4)-sin(q1)*cos(q4))*dq1+(1/2*cos(q3+q1+q2)-1/2*...
%             cos(q3-q1+q2))*sin(q4)*dq2+(1/2*cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*sin(q4)*dq3+((1/2*...
%             sin(q3+q1+q2)-1/2*sin(q3-q1+q2))*cos(q4)-cos(q1)*sin(q4))*dq4;
%   dJ(5,6) = (-((1/2*cos(q3-q1+q2)+1/2*cos(q3+q1+q2))*cos(q4)+sin(q1)*sin(q4))*sin(q5)+(-1/2*sin(q3-q1+q2)-1/2*...
%             sin(q3+q1+q2))*cos(q5))*dq1+(-(1/2*cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*cos(q4)*sin(q5)+(-1/2*...
%             sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*cos(q5))*dq2+(-(1/2*cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*cos(q4)*...
%             sin(q5)+(-1/2*sin(q3+q1+q2)+1/2*sin(q3-q1+q2))*cos(q5))*dq3-(-(1/2*sin(q3+q1+q2)-1/2*...
%             sin(q3-q1+q2))*sin(q4)-cos(q1)*cos(q4))*sin(q5)*dq4+(-((1/2*sin(q3+q1+q2)-1/2*sin(q3-q1+q2))*...
%             cos(q4)-cos(q1)*sin(q4))*cos(q5)-(1/2*cos(q3+q1+q2)-1/2*cos(q3-q1+q2))*sin(q5))*dq5;
%  
%   dJ(6,1) = 0;
%   dJ(6,2) = 0;
%   dJ(6,3) = 0;
%   dJ(6,4) = sin(q2+q3)*(dq2+dq3);
%   dJ(6,5) = -cos(q2+q3)*sin(q4)*dq2-cos(q2+q3)*sin(q4)*dq3-sin(q2+q3)*cos(q4)*dq4;
%   dJ(6,6) = (cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*cos(q5))*dq2+(cos(q2+q3)*cos(q4)*sin(q5)+sin(q2+q3)*...
%             cos(q5))*dq3-sin(q2+q3)*sin(q4)*sin(q5)*dq4+(sin(q2+q3)*cos(q4)*cos(q5)+cos(q2+q3)*sin(q5))*dq5;
